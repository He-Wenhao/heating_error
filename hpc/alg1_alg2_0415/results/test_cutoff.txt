def test_cutoff():

    #construct para
    def p(cut_off):
        Omega_R = 2*np.pi*30*MHz
        ini_state= (qutip.tensor(qutip.fock_dm(2,0),qutip.fock_dm(2,0)))    # init condition
        phonon_ini = (qutip.fock_dm(cut_off,0)) # init of phonon
        amplitude = {0:lambda t: Omega_R,1:lambda t: Omega_R}
        para = trap_config.trap_para(ion_number = 3, laser_ion_list = [0,1],omega_ax = 0.32*2*np.pi*MHz,omega_ra = 2.18*2*np.pi*MHz, cut_off = cut_off,heating_rate = 1e0,t_tol = None,lamb_dicke = 0.1,_ini_state=ini_state,_phonon_ini=phonon_ini,basis = 'Gellman',amplitude = amplitude, detuning = 20*kHz,lind_type = [],if_testXX=True)
        return para

    
    for cut_off in [2,3,4,5,6,7,8,9]:
        t4 = time.time()
        para = p(cut_off)
        alg2_noLind = sim_method_2L.alg2_noLind(para).sim()
        t5 = time.time()
        print('alg2_noLind:','time =',t5-t4,'\n',alg2_noLind)
        print('cut_off =',cut_off)



(base) hewenhao@hewenhaos-MacBook-Pro alg1_alg2 % python3 main.py
initialize: 3 ions
phonon frequency: [2010619.29829747 3490539.81567891 4856094.9068006 ]
root of Theta = pi/4: 4.490428385903473 us; error:Delta Theta = 4.440892098500626e-16
alpha0,1: [(0.4685797735788487-0.08405740817409355j), (-0.3430273029778139-0.03203590729397484j), (0.1408944336203753-0.013256404920206607j)] [(0.46857977357884867-0.08405740817409353j), (3.029556823453081e-17+2.8293550016410504e-18j), (-0.28178886724075075+0.02651280984041323j)]
alg2_noLind: time = 2.327687978744507 
 [[ 0.28341986-6.19489000e-19j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j -0.09406365-2.29832140e-01j]
 [ 0.        +0.00000000e+00j  0.21658014+9.22341067e-19j
   0.09406365+1.49151169e-02j  0.        +0.00000000e+00j]
 [ 0.        +0.00000000e+00j  0.09406365-1.49151169e-02j
   0.21658014-1.89361478e-18j  0.        +0.00000000e+00j]
 [-0.09406365+2.29832140e-01j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j  0.28341986+9.55397882e-19j]]
cut_off = 2
initialize: 3 ions
phonon frequency: [2010619.29829747 3490539.81567891 4856094.9068006 ]
root of Theta = pi/4: 4.490428385903473 us; error:Delta Theta = 4.440892098500626e-16
alpha0,1: [(0.4685797735788487-0.08405740817409355j), (-0.3430273029778139-0.03203590729397484j), (0.1408944336203753-0.013256404920206607j)] [(0.46857977357884867-0.08405740817409353j), (3.029556823453081e-17+2.8293550016410504e-18j), (-0.28178886724075075+0.02651280984041323j)]
alg2_noLind: time = 1.9538371562957764 
 [[ 0.35106876+2.13650719e-18j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j -0.03708733-2.57948750e-01j]
 [ 0.        +0.00000000e+00j  0.14893124-1.55417421e-18j
   0.03708733+1.50095666e-02j  0.        +0.00000000e+00j]
 [ 0.        +0.00000000e+00j  0.03708733-1.50095666e-02j
   0.14893124+5.69147828e-19j  0.        +0.00000000e+00j]
 [-0.03708733+2.57948750e-01j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j  0.35106876+5.08081332e-19j]]
cut_off = 3
initialize: 3 ions
phonon frequency: [2010619.29829747 3490539.81567891 4856094.9068006 ]
root of Theta = pi/4: 4.490428385903473 us; error:Delta Theta = 4.440892098500626e-16
alpha0,1: [(0.4685797735788487-0.08405740817409355j), (-0.3430273029778139-0.03203590729397484j), (0.1408944336203753-0.013256404920206607j)] [(0.46857977357884867-0.08405740817409353j), (3.029556823453081e-17+2.8293550016410504e-18j), (-0.28178886724075075+0.02651280984041323j)]
alg2_noLind: time = 1.5912678241729736 
 [[ 0.32996627+1.93407044e-18j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j -0.05749716-2.55621667e-01j]
 [ 0.        +0.00000000e+00j  0.17003373-1.79974904e-18j
   0.05749716+1.49691520e-02j  0.        +0.00000000e+00j]
 [ 0.        +0.00000000e+00j  0.05749716-1.49691520e-02j
   0.17003373-2.10874359e-18j  0.        +0.00000000e+00j]
 [-0.05749716+2.55621667e-01j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j  0.32996627+4.04266711e-20j]]
cut_off = 4
initialize: 3 ions
phonon frequency: [2010619.29829747 3490539.81567891 4856094.9068006 ]
root of Theta = pi/4: 4.490428385903473 us; error:Delta Theta = 4.440892098500626e-16
alpha0,1: [(0.4685797735788487-0.08405740817409355j), (-0.3430273029778139-0.03203590729397484j), (0.1408944336203753-0.013256404920206607j)] [(0.46857977357884867-0.08405740817409353j), (3.029556823453081e-17+2.8293550016410504e-18j), (-0.28178886724075075+0.02651280984041323j)]
alg2_noLind: time = 1.9318490028381348 
 [[ 0.33504294+8.80171776e-19j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j -0.05245323-2.55764451e-01j]
 [ 0.        +0.00000000e+00j  0.16495706-3.68350606e-19j
   0.05245323+1.49739060e-02j  0.        +0.00000000e+00j]
 [ 0.        +0.00000000e+00j  0.05245323-1.49739060e-02j
   0.16495706-9.54128425e-19j  0.        +0.00000000e+00j]
 [-0.05245323+2.55764451e-01j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j  0.33504294+3.50362083e-19j]]
cut_off = 5
initialize: 3 ions
phonon frequency: [2010619.29829747 3490539.81567891 4856094.9068006 ]
root of Theta = pi/4: 4.490428385903473 us; error:Delta Theta = 4.440892098500626e-16
alpha0,1: [(0.4685797735788487-0.08405740817409355j), (-0.3430273029778139-0.03203590729397484j), (0.1408944336203753-0.013256404920206607j)] [(0.46857977357884867-0.08405740817409353j), (3.029556823453081e-17+2.8293550016410504e-18j), (-0.28178886724075075+0.02651280984041323j)]
alg2_noLind: time = 1.681976079940796 
 [[ 0.33406283-2.42178012e-18j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j -0.0534321 -2.55757465e-01j]
 [ 0.        +0.00000000e+00j  0.16593717+1.83036267e-18j
   0.0534321 +1.49735991e-02j  0.        +0.00000000e+00j]
 [ 0.        +0.00000000e+00j  0.0534321 -1.49735991e-02j
   0.16593717+1.77422831e-18j  0.        +0.00000000e+00j]
 [-0.0534321 +2.55757465e-01j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j  0.33406283-3.59573873e-18j]]
cut_off = 6
initialize: 3 ions
phonon frequency: [2010619.29829747 3490539.81567891 4856094.9068006 ]
root of Theta = pi/4: 4.490428385903473 us; error:Delta Theta = 4.440892098500626e-16
alpha0,1: [(0.4685797735788487-0.08405740817409355j), (-0.3430273029778139-0.03203590729397484j), (0.1408944336203753-0.013256404920206607j)] [(0.46857977357884867-0.08405740817409353j), (3.029556823453081e-17+2.8293550016410504e-18j), (-0.28178886724075075+0.02651280984041323j)]
alg2_noLind: time = 1.8136470317840576 
 [[ 0.3342197 +1.56817766e-18j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j -0.05327527-2.55757748e-01j]
 [ 0.        +0.00000000e+00j  0.1657803 -2.59573048e-19j
   0.05327527+1.49736133e-02j  0.        +0.00000000e+00j]
 [ 0.        +0.00000000e+00j  0.05327527-1.49736133e-02j
   0.1657803 -2.27068141e-18j  0.        +0.00000000e+00j]
 [-0.05327527+2.55757748e-01j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j  0.3342197 +3.15068986e-18j]]
cut_off = 7
initialize: 3 ions
phonon frequency: [2010619.29829747 3490539.81567891 4856094.9068006 ]
root of Theta = pi/4: 4.490428385903473 us; error:Delta Theta = 4.440892098500626e-16
alpha0,1: [(0.4685797735788487-0.08405740817409355j), (-0.3430273029778139-0.03203590729397484j), (0.1408944336203753-0.013256404920206607j)] [(0.46857977357884867-0.08405740817409353j), (3.029556823453081e-17+2.8293550016410504e-18j), (-0.28178886724075075+0.02651280984041323j)]
alg2_noLind: time = 2.0445680618286133 
 [[ 0.3341983 -2.08790541e-18j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j -0.05329667-2.55757738e-01j]
 [ 0.        +0.00000000e+00j  0.1658017 +4.46467113e-18j
   0.05329667+1.49736128e-02j  0.        +0.00000000e+00j]
 [ 0.        +0.00000000e+00j  0.05329667-1.49736128e-02j
   0.1658017 +8.57675775e-19j  0.        +0.00000000e+00j]
 [-0.05329667+2.55757738e-01j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j  0.3341983 -1.30512510e-18j]]
cut_off = 8
initialize: 3 ions
phonon frequency: [2010619.29829747 3490539.81567891 4856094.9068006 ]
root of Theta = pi/4: 4.490428385903473 us; error:Delta Theta = 4.440892098500626e-16
alpha0,1: [(0.4685797735788487-0.08405740817409355j), (-0.3430273029778139-0.03203590729397484j), (0.1408944336203753-0.013256404920206607j)] [(0.46857977357884867-0.08405740817409353j), (3.029556823453081e-17+2.8293550016410504e-18j), (-0.28178886724075075+0.02651280984041323j)]
alg2_noLind: time = 1.9732201099395752 
 [[ 0.33420084-9.42215946e-19j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j -0.05329413-2.55757738e-01j]
 [ 0.        +0.00000000e+00j  0.16579916+8.45436341e-19j
   0.05329413+1.49736128e-02j  0.        +0.00000000e+00j]
 [ 0.        +0.00000000e+00j  0.05329413-1.49736128e-02j
   0.16579916-1.82800224e-18j  0.        +0.00000000e+00j]
 [-0.05329413+2.55757738e-01j  0.        +0.00000000e+00j
   0.        +0.00000000e+00j  0.33420084-2.20129569e-19j]]
cut_off = 9